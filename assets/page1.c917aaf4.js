import{_ as y}from"./_plugin-vue_export-helper.cdc0426e.js";import{q as V,h as f,i as w,x,r,o as C,j as k,d as u,e as l,w as t,F as E,y as D,E as I,z as b,f as p}from"./index.eb8f4e47.js";const q={name:"page1",setup(){const{proxy:s}=V(),o=f([]),h=async()=>{o.value=await s.$api.getFileData()};w(()=>{h()});const e=f(!1),F=n=>{D.confirm("\u786E\u5B9A\u5173\u95ED?").then(()=>{s.$refs.fileForm.resetFields(),n()}).catch(()=>{})},d=x({title:"",url:"",html:"",ID:""}),m=async()=>{const n=f({});s.$refs.fileForm.validate(async v=>{if(v){if(i.value==="add"?(d.ID=s.$api.randomString(9),n.value=await s.$api.addFile(d)):n.value=await s.$api.editFile(d),n.value.msg==="success"){const a=d.title;e.value=!1,s.$refs.fileForm.resetFields(),await h(),I({title:i.value==="add"?"\u63D0\u4EA4\u6210\u529F":"\u66F4\u65B0\u6210\u529F",message:`${a}\u4E0A\u4F20\u6210\u529F`,duration:2e3})}}else b({showClose:!0,message:"\u8BF7\u6309\u7167\u8981\u6C42\u4E66\u5199",type:"error"})})},c=n=>{i.value="edit",e.value=!0,s.$nextTick(()=>{Object.assign(d,n)})},g=()=>{i.value="add",e.value=!0},_=()=>{b({showClose:!0,message:"\u8BF7\u8054\u7CFB\u8D85\u7EA7\u7BA1\u7406\u5458\u5220\u9664",type:"error"})},i=f("add");return{FileList:o,dialogVisible:e,handleClose:F,formFile:d,submit:m,handleEdit:c,handleAdd:g,action:i,handleDelete:_}}},B={class:"file-header"},N=p("\u65B0\u589E"),U={class:"table"},z={style:{height:"550px",overflow:"scroll",width:"100%"}},L=p(" \u7F16\u8F91 "),M=p(" \u5220\u9664 "),j=["src"],A={style:{width:"100%","text-align":"right"}},O=p("\u63D0\u4EA4");function T(s,o,h,e,F,d){const m=r("el-button"),c=r("el-table-column"),g=r("el-table"),_=r("el-input"),i=r("el-form-item"),n=r("el-form"),v=r("el-dialog");return C(),k(E,null,[u("div",B,[l(m,{type:"primary",onClick:e.handleAdd},{default:t(()=>[N]),_:1},8,["onClick"])]),u("div",U,[u("div",z,[l(g,{data:e.FileList,style:{width:"100%"}},{default:t(()=>[l(c,{prop:"fileId",label:"\u7269\u79CDID"}),l(c,{prop:"title",label:"\u7269\u79CD\u540D\u79F0"}),l(c,{fixed:"right",label:"Operations",width:"120"},{default:t(a=>[l(m,{link:"",type:"primary",size:"small",onClick:S=>e.handleEdit(a.row)},{default:t(()=>[L]),_:2},1032,["onClick"]),l(m,{link:"",type:"danger",size:"small",onClick:e.handleDelete},{default:t(()=>[M]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])])]),l(v,{modelValue:e.dialogVisible,"onUpdate:modelValue":o[3]||(o[3]=a=>e.dialogVisible=a),title:e.action==="add"?"\u6DFB\u52A0\u7269\u79CD":"\u7F16\u8F91\u7269\u79CD",width:"80%","before-close":e.handleClose},{default:t(()=>[l(n,{inline:!1,model:e.formFile,ref:"fileForm"},{default:t(()=>[l(i,{label:"\u7269\u79CD\u540D\u79F0",prop:"title",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7269\u79CD\u540D\u79F0"}]},{default:t(()=>[l(_,{modelValue:e.formFile.title,"onUpdate:modelValue":o[0]||(o[0]=a=>e.formFile.title=a),placeholder:"\u8BF7\u8F93\u5165\u7269\u79CD\u540D\u79F0"},null,8,["modelValue"])]),_:1}),l(i,{label:"\u5C01\u9762\u56FE\u7247\u5730\u5740",prop:"url",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5C01\u9762\u56FE\u7247\u5730\u5740"}]},{default:t(()=>[l(_,{modelValue:e.formFile.url,"onUpdate:modelValue":o[1]||(o[1]=a=>e.formFile.url=a),placeholder:"\u8BF7\u7C98\u8D34\u5C01\u9762\u56FE\u7247\u5730\u5740"},null,8,["modelValue"]),u("img",{src:e.formFile.url,alt:"",style:{width:"80%","margin-top":"20px"}},null,8,j)]),_:1}),l(i,{label:"\u6B63\u6587\u5185\u5BB9",prop:"html",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6B63\u6587\u5185\u5BB9"}]},{default:t(()=>[l(_,{modelValue:e.formFile.html,"onUpdate:modelValue":o[2]||(o[2]=a=>e.formFile.html=a),rows:5,type:"textarea",placeholder:"\u8BF7\u7C98\u8D34\u6B63\u6587\u5185\u5BB9"},null,8,["modelValue"])]),_:1}),l(i,null,{default:t(()=>[u("div",A,[l(m,{type:"primary",onClick:e.submit},{default:t(()=>[O]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title","before-close"])],64)}const J=y(q,[["render",T],["__scopeId","data-v-2380e6fe"]]);export{J as default};
